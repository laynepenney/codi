# Multi-Model Peer Review Workflow
# This workflow demonstrates peer review using multiple AI models with different strengths
name: multi-model-peer-review
description: A comprehensive peer review process using different models for analysis and synthesis

steps:
  # Step 1: Initial code review with fast model (Haiku)
  - id: initial-review
    action: ai-prompt
    description: "Fast initial review with Haiku model"
    prompt: |
      Review the following code for:
      - Basic syntax errors
      - Obvious bugs
      - Code style issues
      - Quick quality checks
      
      Keep your response brief and focused on critical issues only.
    model: "claude-3-5-haiku-latest"

  # Step 2: Detailed analysis with capable model (Sonnet)
  - id: detailed-analysis
    action: switch-model
    description: "Switch to Sonnet for detailed analysis"
    model: "claude-sonnet-4-20250514"

  - id: deep-review
    action: ai-prompt
    description: "Deep analysis with Sonnet model"
    prompt: |
      Based on the initial review, perform a detailed analysis:
      - Architecture and design patterns
      - Security vulnerabilities
      - Performance considerations
      - Test coverage gaps
      - Documentation completeness
      
      Provide specific, actionable feedback with code examples where appropriate.

  # Step 3: Different perspective with another provider (GPT-4)
  - id: perspective-switch
    action: switch-model
    description: "Switch to GPT-4 for alternative perspective"
    model: "gpt-4o"

  - id: alternative-review
    action: ai-prompt
    description: "Alternative perspective from GPT-4"
    prompt: |
      Review the code from a different perspective:
      - Identify issues not mentioned in previous reviews
      - Suggest alternative approaches
      - Focus on edge cases and error handling
      - Propose modern best practices
      
      Complement the previous reviews rather than repeating them.

  # Step 4: Synthesis with reasoning model (original Sonnet)
  - id: synthesis-switch
    action: switch-model
    description: "Switch back to Sonnet for synthesis"
    model: "claude-sonnet-4-20250514"

  - id: synthesize-feedback
    action: ai-prompt
    description: "Synthesize all feedback into actionable recommendations"
    prompt: |
      Synthesize the feedback from all three models (Haiku, Sonnet, GPT-4) into:
      1. Critical issues (must fix before merge)
      2. Important improvements (should fix soon)
      3. Nice-to-have enhancements (consider for future)
      
      Provide a prioritized action plan with clear ownership and estimated effort.

  # Step 5: Final summary
  - id: final-summary
    action: shell
    description: "Log completion of peer review"
    command: |
      echo "Multi-model peer review completed successfully"
      echo "Models used: Haiku (fast), Sonnet (deep), GPT-4 (perspective)"
      echo "Synthesis completed by Sonnet"
